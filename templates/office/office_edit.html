{# templates/office/office_edit.html #}
{% extends "template_base.html" %}

{% block title %}{% if office %}{{ office.office_name }}{% else %}Create New Office{% endif %}{% endblock %}

{%  block content %}
{% load template_filters %}

<h1>{% if office %}Edit {{ office.office_name|default_if_none:"" }}{% else %}
    Create New Office{% endif %}</h1>
<form action="{% url "office:office_edit_process" %}" method="post">
{% csrf_token %}

<input type="hidden" name="office_id" value="{% if office %}{{ office.id }}{% else %}0{% endif %}">

    <table>
{% if office %}
        <tr>
            <td>Local Office ID:</td>
            <td>{{ office.id }}</td>
        </tr>
        <tr>
            <td>Office We Vote ID:</td>
            <td>{{ office.we_vote_id }}</td>
        </tr>
{% endif %}
        <tr>
            <td>Office Name:</td>
            <td>
{% if office %}
    {% if office.google_civic_election_id|convert_to_int < 1000000 %}{# If we have an id issued by Google, don't allow the name to be edited. #}
        {{ office.office_name }}
    {% else %}
        <input type="text" name="office_name" id="office_name_id" value="{{ office.office_name|default_if_none:"" }}" /><br />
    {% endif %}
{% else %}
     <input type="text" name="office_name" id="office_name_id" value="" /><br />
{% endif %}</td>
        </tr>
        <tr>
            <td>Google Civic ID:</td>
            <td>
{% if office %}
    {% if office.google_civic_election_id|convert_to_int < 1000000 %}{# If we have an id issued by Google, don't allow it to be edited. #}
        {{ office.google_civic_election_id }}
    {% else %}
        <input type="text" name="google_civic_election_id" value="{% if office %}{{ office.google_civic_election_id|default_if_none:"" }}{% endif %}" /><br />
    {% endif %}
{% else %}
    <input type="text" name="google_civic_election_id" value="{{ google_civic_election_id }}" /><br />
{% endif %}</td>
        </tr>
{% if office %}
        <tr>
            <td>State Code:</td>
            <td>{{ office.get_office_state }}</td>
        </tr>
        <tr>
            <td>Primary Party:</td>
            <td>
    {% if office.google_civic_election_id|convert_to_int < 1000000 %}{# If we have an id issued by Google, don't allow it to be edited. #}
                {{ office.primary_party }}
    {% else %}
                <input type="text" name="primary_party" value="{{ primary_party }}" /><br />
    {% endif %}
            </td>
        </tr>
{% endif %}
    </table>

{% if office %}
<p><a href="{% url 'office:office_summary' office.id %}">cancel</a>
{% else %}
<p><a href="{% url 'office:office_list' %}?google_civic_election_id={{ google_civic_election_id }}">cancel</a>
{% endif %}

<input type="submit" value="{% if office %}Update Office{% else %}Create New Office{% endif %}" /></p>

</form>
{% endblock %}